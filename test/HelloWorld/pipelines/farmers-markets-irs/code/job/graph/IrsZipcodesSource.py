from pyspark.sql import *
from pyspark.sql.functions import *
from pyspark.sql.types import *
from job.config.ConfigStore import *
from job.udfs.UDFs import *

def IrsZipcodesSource(spark: SparkSession) -> DataFrame:
    return spark.read\
        .schema(
          StructType([
            StructField("STATEFIPS", IntegerType(), True), StructField("STATE", StringType(), True), StructField("zipcode", IntegerType(), True), StructField("agi_stub", IntegerType(), True), StructField("N1", DoubleType(), True), StructField("MARS1", DoubleType(), True), StructField("MARS2", DoubleType(), True), StructField("MARS4", DoubleType(), True), StructField("PREP", DoubleType(), True), StructField("N2", DoubleType(), True), StructField("NUMDEP", DoubleType(), True), StructField("A00100", DoubleType(), True), StructField("N02650", DoubleType(), True), StructField("A02650", DoubleType(), True), StructField("N00200", DoubleType(), True), StructField("A00200", DoubleType(), True), StructField("N00300", DoubleType(), True), StructField("A00300", DoubleType(), True), StructField("N00600", DoubleType(), True), StructField("A00600", DoubleType(), True), StructField("N00650", DoubleType(), True), StructField("A00650", DoubleType(), True), StructField("N00700", DoubleType(), True), StructField("A00700", DoubleType(), True), StructField("N00900", DoubleType(), True), StructField("A00900", DoubleType(), True), StructField("N01000", DoubleType(), True), StructField("A01000", DoubleType(), True), StructField("N01400", DoubleType(), True), StructField("A01400", DoubleType(), True), StructField("N01700", DoubleType(), True), StructField("A01700", DoubleType(), True), StructField("SCHF", DoubleType(), True), StructField("N02300", DoubleType(), True), StructField("A02300", DoubleType(), True), StructField("N02500", DoubleType(), True), StructField("A02500", DoubleType(), True), StructField("N26270", DoubleType(), True), StructField("A26270", DoubleType(), True), StructField("N02900", DoubleType(), True), StructField("A02900", DoubleType(), True), StructField("N03220", DoubleType(), True), StructField("A03220", DoubleType(), True), StructField("N03300", DoubleType(), True), StructField("A03300", DoubleType(), True), StructField("N03270", DoubleType(), True), StructField("A03270", DoubleType(), True), StructField("N03150", DoubleType(), True), StructField("A03150", DoubleType(), True), StructField("N03210", DoubleType(), True), StructField("A03210", DoubleType(), True), StructField("N03230", DoubleType(), True), StructField("A03230", DoubleType(), True), StructField("N03240", DoubleType(), True), StructField("A03240", DoubleType(), True), StructField("N04470", DoubleType(), True), StructField("A04470", DoubleType(), True), StructField("A00101", DoubleType(), True), StructField("N18425", DoubleType(), True), StructField("A18425", DoubleType(), True), StructField("N18450", DoubleType(), True), StructField("A18450", DoubleType(), True), StructField("N18500", DoubleType(), True), StructField("A18500", DoubleType(), True), StructField("N18300", DoubleType(), True), StructField("A18300", DoubleType(), True), StructField("N19300", DoubleType(), True), StructField("A19300", DoubleType(), True), StructField("N19700", DoubleType(), True), StructField("A19700", DoubleType(), True), StructField("N04800", DoubleType(), True), StructField("A04800", DoubleType(), True), StructField("N05800", DoubleType(), True), StructField("A05800", DoubleType(), True), StructField("N09600", DoubleType(), True), StructField("A09600", DoubleType(), True), StructField("N07100", DoubleType(), True), StructField("A07100", DoubleType(), True), StructField("N07300", DoubleType(), True), StructField("A07300", DoubleType(), True), StructField("N07180", DoubleType(), True), StructField("A07180", DoubleType(), True), StructField("N07230", DoubleType(), True), StructField("A07230", DoubleType(), True), StructField("N07240", DoubleType(), True), StructField("A07240", DoubleType(), True), StructField("N07220", DoubleType(), True), StructField("A07220", DoubleType(), True), StructField("N07260", DoubleType(), True), StructField("A07260", DoubleType(), True), StructField("N09400", DoubleType(), True), StructField("A09400", DoubleType(), True), StructField("N10600", DoubleType(), True), StructField("A10600", DoubleType(), True), StructField("N59660", DoubleType(), True), StructField("A59660", DoubleType(), True), StructField("N59720", DoubleType(), True), StructField("A59720", DoubleType(), True), StructField("N11070", DoubleType(), True), StructField("A11070", DoubleType(), True), StructField("N10960", DoubleType(), True), StructField("A10960", DoubleType(), True), StructField("N06500", DoubleType(), True), StructField("A06500", DoubleType(), True), StructField("N10300", DoubleType(), True), StructField("A10300", DoubleType(), True), StructField("N85330", DoubleType(), True), StructField("A85330", DoubleType(), True), StructField("N85300", DoubleType(), True), StructField("A85300", DoubleType(), True), StructField("N11901", DoubleType(), True), StructField("A11901", DoubleType(), True), StructField("N11902", DoubleType(), True), StructField("A11902", DoubleType(), True)
        ])
        )\
        .option("header", True)\
        .option("inferSchema", True)\
        .option("sep", ",")\
        .csv("dbfs:/databricks-datasets/data.gov/irs_zip_code_data/data-001/2013_soi_zipcode_agi.csv")
